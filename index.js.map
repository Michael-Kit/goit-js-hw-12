{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nconst API_KEY = '51392705-c835407a6ad34302eafe3f79f';\nconst BASE_URL = 'https://pixabay.com/api/';\n\n// функція HTTP запитів \nexport async function getImagesByQuery(query, page = 1, perPage = 15) {\n  const response = await axios.get(BASE_URL, {\n    params: {\n      key: API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page,\n      per_page: perPage,\n    },\n  });\n  return response.data;\n}\n","// Описаний у документації\nimport SimpleLightbox from \"simplelightbox\";\n// Додатковий імпорт стилів\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nexport function hideLoader() {\n  const loader = document.querySelector('.loader');\n  if (loader) loader.classList.add('hidden');\n}\n\nexport function showLoader() {\n  const loader = document.querySelector('.loader');\n  if (loader) loader.classList.remove('hidden');\n}\n\n\nexport function clearGallery() {\n  const gallery = document.querySelector('.gallery');\n  if (gallery) {\n    gallery.innerHTML = '';\n  }\n}\n\nexport function createGallery(images) {\n  const gallery = document.querySelector('.gallery');\n  const markup = images.map(image => {\n    return `\n      <li class=\"gallery-item\">\n        <a href=\"${image.largeImageURL}\">\n          <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" />\n        </a>\n       <div class=\"info\">\n           <div class=\"labels\">\n              <span>Likes</span>\n              <span>Views</span>\n              <span>Comments</span>\n              <span>Downloads</span>\n           </div>\n         <div class=\"stats\">\n              <span>${image.likes}</span>\n              <span>${image.views}</span>\n              <span>${image.comments}</span>\n              <span>${image.downloads}</span>\n         </div>\n       </div>\n\n      </li>\n    `;\n  }).join('');\n\n  gallery.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n}\nexport function showLoadMoreButton() {\n  const btn = document.querySelector('.load-more');\n  if (btn) btn.classList.remove('hidden');\n}\n\nexport function hideLoadMoreButton() {\n  const btn = document.querySelector('.load-more');\n  if (btn) btn.classList.add('hidden');\n}\n","// Імпорт API-функції для отримання зображень\nimport { getImagesByQuery } from './js/pixabay-api.js';\n\n// Імпорт функцій візуального рендерингу\nimport {\n  createGallery,        // додає картинки до DOM\n  clearGallery,         // очищає галерею перед новим запитом\n  showLoader,           // показує loader\n  hideLoader,           // ховає loader\n  showLoadMoreButton,   // показує кнопку \"Load more\"\n  hideLoadMoreButton    // ховає кнопку \"Load more\"\n} from './js/render-functions.js';\n\n// Імпорт сповіщень (бібліотека iziToast)\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\n// Знаходимо DOM-елементи\nconst form = document.querySelector('.form');\nconst input = form.elements['search-text'];\nconst loadMoreBtn = document.querySelector('.load-more');\n\n// Змінні для відстеження запитів\nlet currentPage = 1;\nlet currentQuery = '';\n\n// Обробка форми пошуку\nform.addEventListener('submit', async (e) => {\n  e.preventDefault();                       // зупиняємо перезавантаження сторінки\n  const query = input.value.trim();        // отримуємо пошуковий текст\n\n  if (!query) {\n    // якщо поле порожнє — показуємо попередження\n    iziToast.show({\n      message: \"Please fill out this field !\",\n      backgroundColor: \"#ff4e4e\",\n      position: \"topRight\",\n    });\n    return;\n  }\n\n  // Оновлюємо стан\n  currentPage = 1;\n  currentQuery = query;\n\n  // Підготовка до нового запиту\n  clearGallery();         // очищаємо галерею\n  showLoader();           // показуємо loader\n\n  try {\n    // Виконуємо запит\n    const data = await getImagesByQuery(query);\n    hideLoader();         // ховаємо loader після отримання\n\n    if (data.hits.length === 0) {\n      // якщо немає зображень — показуємо попередження\n      iziToast.show({\n        message: \"Sorry, there are no images matching your search query. Please try again!\",\n        backgroundColor: \"#ff4e4e\",\n        position: \"topRight\",\n      });\n      hideLoadMoreButton();\n      return;\n    }\n\n    // Рендеримо зображення\n    createGallery(data.hits);\n    showLoadMoreButton();       // показуємо кнопку \"Load more\"\n    input.value = '';           // очищаємо поле вводу\n\n    // Показуємо повідомлення про успіх\n    iziToast.show({\n      message: `Found ${data.hits.length} images.`,\n      backgroundColor: \"#00c851\",\n      position: \"topRight\",\n      timeout: 3000,\n    });\n\n  } catch (error) {\n    // В разі помилки — інформуємо користувача\n    hideLoader();\n    console.error('Помилка запиту:', error.message);\n    iziToast.show({\n      message: \"An error occurred while fetching images. Please try again later.\",\n      backgroundColor: \"#ffcc00\",\n      position: \"topRight\",\n    });\n  }\n});\n\n// Обробка кнопки \"Load more\"\nloadMoreBtn.addEventListener('click', async () => {\n  currentPage++;          // переходимо до наступної сторінки + 1 сторінка\n  showLoader();\n\n  try {\n    // ⛲ Запит на наступну сторінку\n    const data = await getImagesByQuery(currentQuery, currentPage);\n    hideLoader();\n    createGallery(data.hits);  // додаємо нові картинки\n\n    // Плавна прокрутка до нових зображень\n    const { height: cardHeight } = document\n      .querySelector('.gallery')\n      .firstElementChild.getBoundingClientRect();\n\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n\n    const totalShownImages = currentPage * 15;\n\nif (totalShownImages >= data.totalHits)\n       {\n      hideLoadMoreButton();\n      iziToast.show({\n        message: \"You've reached the end of search results.\",\n        backgroundColor: \"#ffcc00\",\n        position: \"topRight\",\n      });\n    }\n\n  } catch (error) {\n    // В разі помилки при підвантаженні\n    hideLoader();\n    console.error('Помилка завантаження наступної сторінки:', error.message);\n    iziToast.show({\n      message: \"An error occurred while loading more images.\",\n      backgroundColor: \"#ff4e4e\",\n      position: \"topRight\",\n    });\n  }\n});\nconst loadingMessage = document.getElementById('loading-message');\n\nasync function onLoadMoreClick() {\n  loadingMessage.style.display = 'block'; // показати повідомлення\n  \n  try {\n    const data = await fetchImages(); // завантажити зображення\n    createGallery(data.hits);\n    \n    // Плавна прокрутка після рендеру\n    const { height: cardHeight } = document\n      .querySelector('.gallery')\n      .firstElementChild.getBoundingClientRect();\n\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n  } catch (error) {\n    console.error('Error loading images:', error);\n  } finally {\n    loadingMessage.style.display = 'none'; // приховати повідомлення\n  }\n}\n"],"names":["API_KEY","BASE_URL","getImagesByQuery","query","page","perPage","axios","lightbox","SimpleLightbox","hideLoader","loader","showLoader","clearGallery","gallery","createGallery","images","markup","image","showLoadMoreButton","btn","hideLoadMoreButton","form","input","loadMoreBtn","currentPage","currentQuery","iziToast","data","error","cardHeight"],"mappings":"owBAEA,MAAMA,EAAU,qCACVC,EAAW,2BAGV,eAAeC,EAAiBC,EAAOC,EAAO,EAAGC,EAAU,GAAI,CAYpE,OAXiB,MAAMC,EAAM,IAAIL,EAAU,CACzC,OAAQ,CACN,IAAKD,EACL,EAAGG,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAAC,EACA,SAAUC,CACX,CACL,CAAG,GACe,IAClB,CCbA,MAAME,EAAW,IAAIC,EAAe,aAAc,CAChD,aAAc,MACd,aAAc,GAChB,CAAC,EAEM,SAASC,GAAa,CAC3B,MAAMC,EAAS,SAAS,cAAc,SAAS,EAC3CA,GAAQA,EAAO,UAAU,IAAI,QAAQ,CAC3C,CAEO,SAASC,GAAa,CAC3B,MAAMD,EAAS,SAAS,cAAc,SAAS,EAC3CA,GAAQA,EAAO,UAAU,OAAO,QAAQ,CAC9C,CAGO,SAASE,GAAe,CAC7B,MAAMC,EAAU,SAAS,cAAc,UAAU,EAC7CA,IACFA,EAAQ,UAAY,GAExB,CAEO,SAASC,EAAcC,EAAQ,CACpC,MAAMF,EAAU,SAAS,cAAc,UAAU,EAC3CG,EAASD,EAAO,IAAIE,GACjB;AAAA;AAAA,mBAEQA,EAAM,aAAa;AAAA,sBAChBA,EAAM,YAAY,UAAUA,EAAM,IAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBAUtCA,EAAM,KAAK;AAAA,sBACXA,EAAM,KAAK;AAAA,sBACXA,EAAM,QAAQ;AAAA,sBACdA,EAAM,SAAS;AAAA;AAAA;AAAA;AAAA;AAAA,KAMlC,EAAE,KAAK,EAAE,EAEVJ,EAAQ,mBAAmB,YAAaG,CAAM,EAC9CT,EAAS,QAAO,CAClB,CACO,SAASW,GAAqB,CACnC,MAAMC,EAAM,SAAS,cAAc,YAAY,EAC3CA,GAAKA,EAAI,UAAU,OAAO,QAAQ,CACxC,CAEO,SAASC,GAAqB,CACnC,MAAMD,EAAM,SAAS,cAAc,YAAY,EAC3CA,GAAKA,EAAI,UAAU,IAAI,QAAQ,CACrC,CCjDA,MAAME,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAQD,EAAK,SAAS,aAAa,EACnCE,EAAc,SAAS,cAAc,YAAY,EAGvD,IAAIC,EAAc,EACdC,EAAe,GAGnBJ,EAAK,iBAAiB,SAAU,MAAO,GAAM,CAC3C,EAAE,eAAc,EAChB,MAAMlB,EAAQmB,EAAM,MAAM,KAAI,EAE9B,GAAI,CAACnB,EAAO,CAEVuB,EAAS,KAAK,CACZ,QAAS,+BACT,gBAAiB,UACjB,SAAU,UAChB,CAAK,EACD,MACD,CAGDF,EAAc,EACdC,EAAetB,EAGfS,IACAD,IAEA,GAAI,CAEF,MAAMgB,EAAO,MAAMzB,EAAiBC,CAAK,EAGzC,GAFAM,IAEIkB,EAAK,KAAK,SAAW,EAAG,CAE1BD,EAAS,KAAK,CACZ,QAAS,2EACT,gBAAiB,UACjB,SAAU,UAClB,CAAO,EACDN,IACA,MACD,CAGDN,EAAca,EAAK,IAAI,EACvBT,IACAI,EAAM,MAAQ,GAGdI,EAAS,KAAK,CACZ,QAAS,SAASC,EAAK,KAAK,MAAM,WAClC,gBAAiB,UACjB,SAAU,WACV,QAAS,GACf,CAAK,CAEF,OAAQC,EAAO,CAEdnB,IACA,QAAQ,MAAM,kBAAmBmB,EAAM,OAAO,EAC9CF,EAAS,KAAK,CACZ,QAAS,mEACT,gBAAiB,UACjB,SAAU,UAChB,CAAK,CACF,CACH,CAAC,EAGDH,EAAY,iBAAiB,QAAS,SAAY,CAChDC,IACAb,IAEA,GAAI,CAEF,MAAMgB,EAAO,MAAMzB,EAAiBuB,EAAcD,CAAW,EAC7Df,IACAK,EAAca,EAAK,IAAI,EAGvB,KAAM,CAAE,OAAQE,CAAU,EAAK,SAC5B,cAAc,UAAU,EACxB,kBAAkB,sBAAqB,EAE1C,OAAO,SAAS,CACd,IAAKA,EAAa,EAClB,SAAU,QAChB,CAAK,EAEwBL,EAAc,IAEnBG,EAAK,YAEvBP,IACAM,EAAS,KAAK,CACZ,QAAS,4CACT,gBAAiB,UACjB,SAAU,UAClB,CAAO,EAGJ,OAAQE,EAAO,CAEdnB,IACA,QAAQ,MAAM,2CAA4CmB,EAAM,OAAO,EACvEF,EAAS,KAAK,CACZ,QAAS,+CACT,gBAAiB,UACjB,SAAU,UAChB,CAAK,CACF,CACH,CAAC,EACsB,SAAS,eAAe,iBAAiB"}